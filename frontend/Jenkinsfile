pipeline {
    agent any
  stages {
    stage('Prepare') {
      steps {
        checkout scm
        } 
        post {
          success {
            echo "prepare stage success"
          } 
          failure {
            echo "prepare stage failed"
          }
        } 
    }
    stage('Frontend') {
      steps {
        dir('frontend'){
          echo "here is frontend dir"
          sh 'docker build -t frontend ./frontend'
          sh 'docker stop frontend || true && docker rm frontend || true'
          sh 'docker rmi frontend || true'
          sh 'docker run -it -d --rm -p 80:80 --name frontend frontend'
          sh 'docker ps'
        } 
      }
      post {
          always {
            echo "frontend stage complete"
          }
          failure {
            echo "failed"
          } 
          success {
            echo "success"
          }
      } 
    }
  } 
}
